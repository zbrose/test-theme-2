{{ 'goodr-modal.css' | asset_url | stylesheet_tag }}

<div
  class='gdr-modal {% if section.settings.test_mode %}gdr-modal--test-mode{% endif %}'
  data-section-id='{{ section.id }}'
  data-delay='{{ section.settings.delay_time }}'
  data-enabled='{{ section.settings.modal_enabled }}'
  role='region'
>
  <div class='gdr-modal__overlay' aria-hidden='true' data-modal-overlay>
    <div
      class='gdr-modal__content'
      role='dialog'
      aria-modal='true'
      aria-labelledby='modal-title'
      aria-describedby='modal-description'
    >
      <button class='gdr-modal__close-btn' aria-label='Close modal' data-modal-close>
        <img
          src='{{ 'x.svg' | asset_url }}'
          class='gdr-modal__close-icon'
          alt=''
          loading='eager'
          width='20'
          height='20'
        >
      </button>

      {%- comment -%} Render Dynamic Blocks {%- endcomment -%}
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'hero' %}
            {%- render 'goodr-modal-block-hero', block: block -%}

          {% when 'description' %}
            {%- render 'goodr-modal-block-description', block: block -%}

          {% when 'button' %}
            {% if block.settings.button_type == 'confirm' %}
              {%- render 'goodr-modal-button-confirm', block: block -%}
            {% else %}
              {%- render 'goodr-modal-button-dismiss', block: block -%}
            {% endif %}
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</div>

<script src='{{ 'goodr-modal.js' | asset_url }}' defer></script>

{% schema %}
{
  "name": "goodr Modal",
  "settings": [
    {
      "type": "checkbox",
      "id": "modal_enabled",
      "label": "Enable Modal",
      "default": true,
      "info": "Toggle this to show or hide the modal sitewide"
    },
    {
      "type": "header",
      "content": "Advanced Settings"
    },
    {
      "type": "range",
      "id": "delay_time",
      "min": 1,
      "max": 20,
      "step": 1,
      "unit": "sec",
      "label": "Delay Before Showing",
      "default": 2
    },
    {
      "type": "checkbox",
      "id": "test_mode",
      "label": "Force Open (Test Mode)",
      "default": false,
      "info": "Check this to keep the modal open while you style it in the editor"
    }
  ],
  "blocks": [
    {
      "type": "hero",
      "name": "Hero Section",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "modal_logo",
          "label": "Logo"
        },
        {
          "type": "text",
          "id": "modal_logo_alt",
          "label": "Logo Alt Text",
          "default": "Modal Logo"
        },
        {
          "type": "image_picker",
          "id": "modal_image",
          "label": "Desktop Image"
        },
        {
          "type": "image_picker",
          "id": "modal_image_mobile",
          "label": "Mobile Image (Optional)"
        },
        {
          "type": "text",
          "id": "modal_image_alt",
          "label": "Image Alt Text",
          "default": "Modal Image"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description Text",
      "settings": [
        {
          "type": "text",
          "id": "modal_description",
          "label": "Description",
          "default": "USE CODE [code] FOR $5 OFF YOUR FIRST ORDER",
          "info": "Max 50 characters. Use [code] as a placeholder for the discount code"
        },
        {
          "type": "text",
          "id": "discount_code",
          "label": "Discount Code",
          "default": "GOODR5",
          "info": "Max 10 characters. This will replace the [code] placeholder in the description."
        },
        {
          "type": "color",
          "id": "code_text_color",
          "label": "Code Text Color",
          "default": "#e06287"
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "type": "select",
          "id": "button_type",
          "label": "Button Type",
          "options": [
            { "value": "confirm", "label": "Confirm (Link)" },
            { "value": "dismiss", "label": "Dismiss (Close Modal)" }
          ],
          "default": "confirm"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Button"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link",
          "info": "Only used for Confirm button type"
        },
        {
          "type": "color",
          "id": "button_color",
          "label": "Background Color",
          "default": "#EDE939"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#FFFFFF"
        },
        {
          "type": "select",
          "id": "font_style",
          "label": "Font Style",
          "options": [
            { "value": "gdr-modal__button--regular", "label": "Regular" },
            { "value": "gdr-modal__button--bold", "label": "Bold" },
            { "value": "gdr-modal__button--uppercase", "label": "Uppercase" }
          ],
          "default": "gdr-modal__button--regular"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "goodr Modal",
      "category": "Popup",

      "blocks": [
        {
          "type": "hero"
        },
        {
          "type": "description"
        },
        {
          "type": "button",
          "settings": {
            "button_type": "confirm",
            "button_text": "SHOP ALL STYLES",
            "button_link": "/collections/all",
            "button_color": "#EDE939",
            "text_color": "#FFFFFF"
          }
        },
        {
          "type": "button",
          "settings": {
            "button_type": "dismiss",
            "button_text": "NAH, I HATE DEALS"
          }
        }
      ]
    }
  ]
}
{% endschema %}
