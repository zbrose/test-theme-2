{%- assign button_text = block.settings.button_text | default: 'Button' -%}
{%- assign button_color = block.settings.button_color -%}
{%- if button_color == blank -%}
  {%- assign button_color = '#ede939' -%}
{%- endif -%}
{%- assign text_color = block.settings.text_color -%}
{%- if text_color == blank -%}
  {%- assign text_color = '#FFFFFF' -%}
{%- endif -%}

<a
  class='gdr-modal__button gdr-modal__button--confirm {{ block.settings.font_style }}'
  href='{{ block.settings.button_link }}'
  style='background-color: {{ button_color }}; color: {{ text_color }};'
  data-modal-button='confirm'
  data-button-text='{{ button_text | escape }}'
  {{ block.shopify_attributes }}
>
  {{- button_text -}}
</a>

{% stylesheet %}
  .gdr-modal__button--confirm {
    padding: 12px 0;
    border: 2px solid #0c2340;
    border-radius: 25px;
    box-shadow: -4px 4px #0c2340;
    font-weight: 700;
    font-size: 18px;
    text-decoration: none;
    text-shadow: -2.75px 2.75px #0c2340;
    -webkit-text-stroke: 1px #0c2340;
    transition:
      box-shadow 0.3s ease,
      transform 0.3s ease;
    cursor: pointer;
    display: inline-block;
    width: 100%;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
  }

  .gdr-modal__button--confirm:hover {
    box-shadow: 0 0 0 #0c2340;
  }

  .gdr-modal__button--confirm.gdr-modal__button--bold {
    font-weight: 700;
  }

  .gdr-modal__button--confirm.gdr-modal__button--uppercase {
    text-transform: uppercase;
  }

  @media screen and (max-width: 600px) {
    .gdr-modal__button--confirm {
      font-size: 14px;
      padding: 8px 0;
    }
  }
{% endstylesheet %}

{% javascript %}
  document.querySelectorAll('[data-modal-button="confirm"]').forEach((button) => {
    button.addEventListener('click', function () {
      const buttonText = this.getAttribute('data-button-text');
      const href = this.href;

      // TODO: Integrate with analytics service
      // Examples:
      // - Google Analytics 4: gtag('event', 'modal_confirm', { button_text: buttonText, destination_url: href })
      // - Segment: analytics.track('modal_confirm', { button_text: buttonText, destination_url: href })
      // - Custom webhook: fetch('/api/analytics', { method: 'POST', body: JSON.stringify({event: 'modal_confirm', ...}) })

      console.log('Analytics Event: modal_confirm', {
        button_text: buttonText,
        destination_url: href,
      });
    });
  });
{% endjavascript %}
